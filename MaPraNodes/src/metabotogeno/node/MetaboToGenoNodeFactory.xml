<?xml version="1.0" encoding="UTF-8"?>
<knimeNode icon="./IconMetabolite.png" type="Manipulator" xmlns="http://knime.org/node/v2.8" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://knime.org/node/v2.10 http://knime.org/node/v2.10.xsd">
    <name>MetaboToGeno</name>
    
    <shortDescription>
        Transfer of metabolite scores to genes
    </shortDescription>
    
    <fullDescription>
        <intro>
        	<b> MetaboToGeno </b> is part of the metabotype analysis implemented in <b> PheNoBo </b>.
        	This node is the successor of the <b> ScoreMetabolites </b> node and a predecessor of the <b> NetworkScore </b> node.
        	<br/><br/>
        	The aim of MetaboToGeno is to transform the per-metabolite results of ScoreMetabolites into predictions of causal genes.
        	The MetaboToGeno algorithm calculates a score for each gene based on the p values reported by ScoreMetabolites.
        	The score of a gene <i> x </i> indicates the probability that <i> x </i> is the causal gene for the patient's disease given the observed metabotype.
        	<br/><br/>
        	MetaboToGeno requires 3 tables with input data.
	        	<br/>
	        		<b> Output of ScoreMetabolites  </b>: a table produced by the ScoreMetabolites node.
        			MetaboToGeno requires not all columns generated by ScoreMetabolites.
        			This node only depends the metabolite id and the reported p value (column significance).
        		<br/>
        			<b> Associations Metabolite - Gene </b>: a table representing associations between metabolites and genes.
    				These associations can include results from GWAS and data about biochemical reactions (e.g. gene <i> x </i> catalyzes a reaction that forms metabolite <i> y </i>).
    				The associations are represented as pairs metabolite id (e.g. Metabolon id) - gene id (e.g. Ensmebl id).
    				Note that the gene id is allowed to be missing (for a metabolite without known associations) whereas the metabolite id is required in every row. 
    				<b> All metabolites that should be considered in the MetaboToGeno algorithm have to occur at least once in the table </b>.
    			<br/>
    			<b> All genes </b>: a table containing gene ids (e.g. Ensembl gene ids) that represents set of all genes to score.   
    			<br/>  
        	For detailed information about the format of the tables have a look at the example files provided at
        	<a href="https://github.com/marie-sophie/mapra">https://github.com/marie-sophie/mapra</a>.
        	<br/><br/>
        	The MetaboToGeno algorithm is a procedure with 2 main steps.
        	<br/>
        	The first step of the procedure is a score transformation at metabolite level.
        	The p value of each metabolite is converted to the probability that the metabolite is associated with the patient's disease. 
        	A metabolite with p value <i>p</i> assigned a new score <i> 1/(1+np)</i> where <i> n </i> denotes the total number of metabolites.
        	<br/>
        	The second step transfers a metabolite score to all genes that have an association with that metabolite.
        	If a metabolite does not have any known associations, its score is distributed among all genes.
        	There are several methods to handle genes that obtain scores from more than one metabolite.
        	Please have a look at the dialog options.
        	<br/><br/>
        	The output of MetaboToGeno comprises all genes specified in the list of all genes.
        	MetaboToGeno produces a probability for each gene giving the likelihood that the gene is causal for the patient's disease.
        	It further reports the metabolites that contributed most to the score of the gene.
        </intro>
        
        
        <option name="short name of first option (like in the dialog)">description of first option</option>
        <option name="short name of second option (like in the dialog)">description of second option</option>
        <!-- possibly more options that can also be grouped by tabs -->
        <!--
        <tab name="Standard Options">
            <option name="short name of first option (like in the dialog)">description of first option</option>
            <option name="short name of second option (like in the dialog)">description of second option</option>
        </tab>
        <tab name="Advanced Options">
            <option name="short name of first advanced option (like in the dialog)">description of first advanced option</option>
        </tab>
        -->
    </fullDescription>
    
    <ports>
        <inPort index="0" name="ScoreMetabolites">
        	Output of ScoreMetabolites with columns metabolite_id and significance
    	</inPort>
        <inPort index="1" name="Metabolite Gene Association">
        	Table of metabolite - gene pairs with columns metabolite_id and gene_id
    	</inPort>
        <inPort index="2" name="All Genes">
        	Table of all genes with column gene_id
    	</inPort>
        <outPort index="0" name="Gene Scores"> 
        	Table providing scores and metabolite annotations for all genes specified at Input Port 2
    	</outPort>
    </ports>    
</knimeNode>
